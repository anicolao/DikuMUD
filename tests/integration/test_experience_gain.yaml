# Integration test for experience gain on kill
# Verifies that players see "You gained XX experience." when killing a creature

test:
  id: test_experience_gain
  description: "Verify players see experience gain message when killing creatures"
  author: Integration Test Framework
  created: 2025-10-11
  tags: [combat, experience, kill]

setup:
  character:
    name: ExpTester
    password: test
    class: warrior
    level: 22 # Level 22 to use god commands and maximize combat ability
  start_room: 1200 # room with no exits
  gold: 100
  test_extensions:
    - zone_file: zone_1200.yaml
      extension_file: test_data/hammer_object.yml

steps:
  # Step 1: Verify we're in the temple
  - action: look
    description: "Look around to confirm we're in the Chat Room"
    expected:
      - pattern: "Chat|chat"
        message: "Should be in chat room"

  # Step 2: Get Thor's Hammer (now loaded in the room)
  - action: command
    command: "get hammer"
    description: "Pick up Thor's Hammer"
    expected:
      - pattern: "."
        message: "Should pick up the weapon"

  # Step 3: Wield the weapon
  - action: command
    command: "wield hammer"
    description: "Wield Thor's Hammer"
    expected:
      - pattern: "."
        message: "Should wield the weapon"

  # Step 4: Load a weak mobile to kill
  - action: command
    command: "load char 3062"
    description: "Load a weak calot for testing"
    expected:
      - pattern: "."
        message: "Should get some response from load command"

  # Step 5: Look to see what we loaded
  - action: look
    description: "Look to see the loaded mobile"
    expected:
      - pattern: "."
        message: "Should see something"

  # Step 6: Kill the mobile with Thor's Hammer
  # With Thor's Hammer (1d4+200 damage), we should kill instantly
  - action: command
    command: "kill calot"
    description: "Attack the calot with Thor's Hammer"
    delay_after: 3
    expected:
      - pattern: "You gained [0-9]+ experience\\."
        message: "Should see experience gain message with actual amount"

result:
  should_pass: true
  description: "Test passes if we see 'You gained XX experience.' message on kill"
